/**
 * Values in Action Section
 * 
 * Desktop: Left steps list + Right image (pixel-perfect from design)
 * Mobile/Tablet: Single column with images inside cards (like how-it-works)
 */

.via-section {
  @include section-padding;
  background-color: $color-white;

  // Prevent layout shifts inside this section from affecting content below
  // @include until-desktop {
  //   contain: layout style;
  // }
}

.via-container {
  @include container;
}

// ============================================
// SECTION HEADER
// ============================================

.via-header {
  display: flex;
  flex-direction: column;
  gap: $space-16;
  margin-bottom: $space-48;

  @include desktop {
    flex-direction: row;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: $space-48;
  }
}

.via-title {
  @include heading-52;
  flex-shrink: 0;
}

.via-description {
  max-width: 320px;
  color: $color-gray-600;
  font-size: $font-size-14;
  line-height: 1.6;

  @include desktop {
    text-align: left;
    padding-top: $space-8;
  }
}

// ============================================
// CONTENT LAYOUT
// ============================================

.via-content {
  display: grid;
  grid-template-columns: 1fr;
  gap: $space-32;

  @include desktop {
    grid-template-columns: 1fr 1fr;
    gap: $space-48;
    align-items: stretch; // Растягиваем оба элемента на одинаковую высоту
  }
}

// ============================================
// STEPS LIST (Left side on desktop - single column)
// ============================================

.via-steps {
  display: flex;
  flex-direction: column;
  gap: $space-24;
  order: 1;

  @include desktop {
    max-width: 642px;
    order: 1;
  }
}

.via-step {
  padding: $space-24;
  border-radius: $radius-sm;
  cursor: pointer;
  background-color: $color-white;
  border: 1px solid $color-gray-300;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: $space-16;
  width: 100%;

  // Fast transition for background/border - immediate visual feedback
  transition:
    background-color 0.2s ease,
    border-color 0.2s ease,
    box-shadow 0.2s ease;

  @include desktop {
    flex-direction: row;
    padding: $space-16 $space-24;
    flex-wrap: nowrap;
    align-items: flex-start;
  }

  &:hover:not(.is-active) {
    background-color: $color-gray-50;
  }

  &.is-active {
    background-color: $color-secondary-dark;
    border: 1px solid $color-gray-500;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  }
}

.via-step-number {
  font-family: $font-heading;
  font-size: 36px;
  font-style: normal;
  font-weight: $font-weight-medium;
  color: $color-gray-300;
  line-height: 1;
  flex-shrink: 0;
  min-width: 56px;

  // Fast color transition - immediate visual feedback
  transition: color 0.15s ease;

  @include desktop {
    font-size: 42px;
    min-width: 64px;
  }

  .via-step.is-active & {
    font-style: italic;
    color: $color-black;
  }
}

.via-step-content {
  display: flex;
  flex-direction: column;
  gap: $space-4;
  flex: 1;
  padding-top: $space-4;
}

.via-step-title {
  font-family: $font-heading;
  font-size: $font-size-16;
  font-weight: $font-weight-semibold;
  color: $color-gray-400;
  line-height: 1.3;

  // Fast color transition - immediate visual feedback
  transition: color 0.15s ease;

  @include desktop {
    font-size: $font-size-18;
  }

  .via-step.is-active & {
    color: $color-gray-800;
  }
}

.via-step-description {
  font-size: $font-size-14;
  color: $color-gray-400;
  line-height: 1.5;
  overflow: hidden;

  // Fast color transition - text changes immediately
  transition: color 0.15s ease;

  .via-step.is-active & {
    color: $color-gray-700;
  }
}

// ============================================
// STEP IMAGE INSIDE CARD (Mobile/Tablet only)
// ============================================

.via-step-image-mobile {
  width: 100%;
  border-radius: $radius-md;
  overflow: hidden;
  border: 4px solid $color-secondary;
  background-color: $color-white;

  // Hide on desktop - use separate image container instead
  @include desktop {
    display: none !important;
  }

  // Mobile/Tablet: smooth height transition
  @include until-desktop {
    // Default collapsed state
    height: 0;
    max-height: 0;
    margin-top: 0;
    opacity: 0;
    border-width: 0;
    flex-basis: 100%;

    // Smooth transitions for expand/collapse
    transition:
      height 0.4s cubic-bezier(0.4, 0, 0.2, 1),
      max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1),
      margin-top 0.3s cubic-bezier(0.4, 0, 0.2, 1),
      opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1),
      border-width 0.2s ease;

    // Expanded state when card is active
    .via-step.is-active & {
      height: 200px; // Фиксированная высота для мобильных
      max-height: 200px;
      opacity: 1;
      border-width: 4px;
    }
  }

  // Tablet: bigger height
  @include tablet {
    .via-step.is-active & {
      height: 300px;
      max-height: 300px;
    }
  }

  img {
    width: 100%;
    height: 100%;
    display: block;
    object-fit: cover;
  }
}

// ============================================
// STEP IMAGE (Right side on desktop)
// ============================================

.via-image-container {
  display: none; // Hidden on mobile/tablet

  @include desktop {
    display: flex; // Show on desktop
    order: 2;
  }
}

.via-image-wrapper {
  width: 100%;
  height: 100%;
  display: flex;
}

.via-image {
  position: relative;
  border: 4px solid $color-secondary;
  border-radius: $radius-xl;
  overflow: hidden;
  background-color: $color-white;
  width: 100%;
  flex: 1; // Растягиваемся на всю доступную высоту

  img {
    width: 100%;
    height: 100%;
    display: block;
    position: absolute;
    top: 0;
    left: 0;
    object-fit: cover;
    opacity: 0;

    // Smooth fade transition with slight scale for depth
    transition:
      opacity 0.5s cubic-bezier(0.4, 0, 0.2, 1),
      transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    transform: scale(1.02);

    &.is-active {
      opacity: 1;
      z-index: 2;
      transform: scale(1);
    }

    &.is-hidden {
      opacity: 0;
      z-index: 1;
      transform: scale(1.02);
    }
  }
}
